# Simulation 2

Please refer [Final Project Report](../Final%20Project%20Report.pdf) for details about the simulation.

## Dependency
 - Python 3.7
 - Numpy 1.14.5
 - Pytorch version: 1.1.0

## Code Structure

- [src/IRecGAN/real_data](src/IRecGAN/real_data) contains the offline data generated by the simulation
- [src/IRecGAN/gen_data](src/IRecGAN/gen_data) contains the data generated by the model as a result of training
- [src/IRecGAN](src/IRecGAN) contains the code for training and evaluating the model on online and offline datasets 
- [src/data](src/data) contains the code for creating an MDP environment and generating the offline data

 
## Quick Start: 
In the directory of src/IRecGAN, type command: 

```
python main.py --click ../data/gen_click.txt --reward ../data/gen_reward.txt --action ../data/gen_action.txt --model LSTM --nhid 128 --n_layers_usr 2 --optim_nll adam --optim_adv adam --batch_size 128
```

Offline data can be generated by: 
```
python ../data/Generate_data.py
```

The paths in ./data needs to be changed to generate a new environment and the corresponding offline data.
